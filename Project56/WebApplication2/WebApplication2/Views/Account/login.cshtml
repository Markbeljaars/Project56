@using System.Data.SqlClient;
@using System.Diagnostics;
@{
    ViewBag.Title = "Login";

    Layout = "~/Views/Shared/_Layout.cshtml";

    var username = "";
    var password = "";

    if (IsPost)
    {
        username = Request.Form["username"];
        password = Request.Form["password"];

        var conn = new SqlConnection("Data Source=145.24.222.224,8080;Initial Catalog=Project56;User ID=abc;Password=abc123");
        conn.Open();

        try
        {
            var stmt = new SqlCommand("SELECT COUNT(*) FROM Users u WHERE u.Username= '" + username + "' AND u.Password= '" + password + "'", conn);


            int myReader = (int)stmt.ExecuteScalar();
            if (myReader > 0)
            {
                Debug.Write("Succesfully logged in.");
                Session["LoggedIn"] = username;
                if(Session["LoggedIn"] != null)
                {
                    var stmt2 = new SqlCommand("SELECT Type FROM Users u WHERE u.Username= '" + username + "'", conn);
                    SqlDataReader reader2 = stmt2.ExecuteReader();
                    while (reader2.Read()){
                        var accounttype = reader2.GetValue(0);
                        if ((string)accounttype == "admin"){
                            Response.Redirect("/account/adminpage");
                        }
                        else
                        {
                            Response.Redirect("/home/index");
                        }
                    }


                }
            }
            else
            {
                Debug.Write("Login failed.");

            }
        }
        catch (NullReferenceException e)
        {
            Console.WriteLine(e.Message);
        }
    }
}



<h2>login</h2>
<form method="POST">
    Username:<br>
<input type="text" name="username" value="@Request.Form["username"]" placeholder="Ex.: BobEleveld"><br>
    Password:<br>
<input type="password" name="password" value="@Request.Form["password"]" placeholder="Ex.: **********"><br><br>
    
    <input type="submit" value="Submit">
</form>



