@using System.Data.SqlClient;
@using System.Diagnostics;
@using WebApplication2.Models;
@using WebApplication2.Database;
@using WebApplication2.Controllers;
@{
    ViewBag.Title = "UserAccounts";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var username = "";
    var currSession = (Account)Session["LoggedIn"];

    var password = "";
    var name = "";
    var surname = "";
    var address = "";
    var email = "";
    var type = "";

    if (currSession == null || currSession.type == "User")
    {
        Response.Redirect("/account/noadmin");

    }
    else {

        if (IsPost)
        {
            if (Request.Form["Request"] != null)
            {
                username = Request.Form["Username"];
                DatabaseController.connect();

                var myRs = DatabaseController.runQuery("SELECT * FROM Users u WHERE u.Username= '" + username + "'");
                while (myRs.Read())
                {
                    try
                    {
                        if (myRs != null)
                        {
                            Debug.Write("Existing user account");
                            password = myRs["Password"].ToString();
                            name = myRs["Name"].ToString();
                            surname = myRs["Surname"].ToString();
                            address = myRs["Address"].ToString();
                            email = myRs["Email"].ToString();
                            type = myRs["Type"].ToString();

                        }
                        else
                        {
                            < text > Non existing user account.</ text >
                        }
                    }
                    catch (NullReferenceException e)
                    {
                        Console.WriteLine(e.Message);
                    }
                }
                myRs.Close();
            }
            if (Request.Form["Update"] != null)
            {
                password = Request.Form["password"];
                name = Request.Form["name"];
                surname = Request.Form["surname"];
                address = Request.Form["address"];
                email = Request.Form["email"];
                type = Request.Form["type"];



                var cmd = new SqlCommand("UPDATE Users SET password = @1, name = @2, surname = @3, address = @4, email = @5, type = @6 WHERE Username = '" + username + "'", DatabaseController.conn);
                cmd.Parameters.AddWithValue("@1", @password);
                cmd.Parameters.AddWithValue("@2", @name);
                cmd.Parameters.AddWithValue("@3", @surname);
                cmd.Parameters.AddWithValue("@4", @address);
                cmd.Parameters.AddWithValue("@5", @email);
                cmd.Parameters.AddWithValue("@6", @type);

                cmd.ExecuteNonQuery();
                DatabaseController.close();
                Debug.Write("got em");

            }
        }
    }
    }








<h2>Edit user accounts</h2>
<form method="POST">
    Username:<br>
    <input type="text" name="username" value="@Request.Form["username"]" placeholder="Ex.: BobEleveld"><br>
    Password:<br>
    <input type="text" name="password" value="@Request.Form["password"]" placeholder="@password"><br>
    First name:<br>
    <input type="text" name="name" value="@Request.Form["Name"]" placeholder="@name"><br>
    Last name:<br>
    <input type="text" name="surname" value="@Request.Form["Surname"]" placeholder="@surname"><br>
    Address name:<br>
    <input type="text" name="address" value="@Request.Form["Address"]" placeholder="@address"><br>
    E-mail address:<br>
    <input type="text" name="email" value="@Request.Form["Email"]" placeholder="@email"><br>
    Type:<br>
    <input type="text" name="type" value="@Request.Form["Type"]" placeholder="@type"><br>
    <br>

    <input name="Request" type="submit" value="Request"/>
    <input name="Update" type="submit" value="Update"/>
</form>



